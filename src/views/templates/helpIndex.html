{% extends "partials/_master.html" %}

{% from "components/breadcrumb/_macro.njk" import onsBreadcrumb %}
{% from "components/lists/_macro.njk" import onsList %}
{% from "components/toc/_macro.njk" import onsTableOfContents %}
{% from "components/call-to-action/_macro.njk" import onsCallToAction %}
{% from "components/lists/_macro.njk" import onsList %}
{% from "components/related-links/_macro.njk" import onsRelatedLinks %}
{% from "components/panel/_macro.njk" import onsPanel %}

{% block page %}
    {{-
        onsCallToAction({
            "headingText": ctaContent.headingText,
            "paragraphText": ctaContent.paragraphText,
            "button": {
                "text": ctaContent.text,
                "classes": 'btn--small',
                "url": ctaContent.url
            }
        })
    }}    
    <div class="page__container container">
        {{ 
            onsBreadcrumb({
                "ariaLabel": 'Breadcrumb',
                "itemsList": breadcrumbs
            }) 
        }}
        <div class="grid u-mt-s@m">
            <div class="grid__col col-7@m">
                <main id="main-content" role="main" class="page__main {{ pageClasses }}">
                    <h1 class="u-mb-l u-fs-xxl">{{ title }}</h1>
                    {% if helpMetaData.surveyType is defined %}
                        {% if helpMetaData.surveyType === 'online' %}
                            {% set guidancePanelText = guidancePanel.paper.text %}
                            {% set guidancePanelLinkText = guidancePanel.paper.linkText %}                      
                        {% elif helpMetaData.surveyType === 'paper' %}
                            {% set guidancePanelText = guidancePanel.online.text %}
                            {% set guidancePanelLinkText = guidancePanel.online.linkText %}                      
                        {% endif %}
                        {% call onsPanel({
                                "classes": 'u-mb-l',
                                "type": "branded"
                            }) %}
                            <p>{{ guidancePanelText | safe }} <a href="{{ helpMetaData.url }}">{{ guidancePanelLinkText }}</a>.</p>
                        {% endcall %}                        
                    {% endif %}
                    <aside class="toc-container" role="complementary">
                        <nav role="navigation" class="toc" aria-label="{{ gStrings.tocLabel }}">
                            <h2 class="toc__title u-fs-r--b u-mb-no">{{ gStrings.tocTitle }}</h2>
                            <ol class="list--dashed u-mb-m u-mt-no">
                                {% for helpBlock in helpIndex %}
                                    {% if helpBlock.listHeading %}
                                        <h3 class="u-fs-r u-mb-xs u-mt-s">{{ helpBlock.listHeading }}:</h3>
                                    {% elif helpBlock.topic %}
                                        <li class="list__item"><a href="#{{ helpBlock.id }}" class="list__link">{{ helpBlock.topic }}</a></li>
                                    {% endif %}
                                {% endfor %}
                            </ol>
                        </nav>
                    </aside>
                    <section class="section">
                        {% for helpBlock in helpIndex %}
                            {% if helpBlock.listHeading %}
                                <h2 {% if not loop.first %}class="u-mt-xl"{% endif %}>{{ helpBlock.listHeading }}</h2>
                            {% elif helpBlock.topic %}
                                <h3 class="u-mt-m" id="{{ helpBlock.id }}">{{ helpBlock.topic }}</h3>
                            {% elif helpBlock.entries %}
                                {{ 
                                    onsList({
                                        "element": 'ol',
                                        "classes": 'list--prefix list--spacious',
                                        "itemsList": helpBlock.entries
                                    }) 
                                }}
                            {% endif %}
                        {% endfor %}
                    </section>
                </main>
            </div>  
            <div class="grid__col col-4@m push-1@m u-mt-m">
                {{-
                    onsRelatedLinks({
                        "id": 'related-list-block',
                        "title": gStrings.relatedContent,
                        "itemsList": relatedLinks
                    }) 
                }}
            </div>
        </div>
    </div>
{% endblock %}
